import{proxy as p,subscribe as h,snapshot as S}from"valtio/vanilla";const o=p({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),N={state:o,subscribe(e){return h(o,()=>e(o))},push(e,t){e!==o.view&&(o.view=e,t&&(o.data=t),o.history.push(e))},reset(e){o.view=e,o.history=[e]},replace(e){o.history.length>1&&(o.history[o.history.length-1]=e,o.view=e)},goBack(){if(o.history.length>1){o.history.pop();const[e]=o.history.slice(-1);o.view=e}},setData(e){o.data=e}},i={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile(){return typeof window<"u"?Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return i.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isIos(){const e=navigator.userAgent.toLowerCase();return i.isMobile()&&(e.includes("iphone")||e.includes("ipad"))},isHttpUrl(e){return e.startsWith("http://")||e.startsWith("https://")},isArray(e){return Array.isArray(e)&&e.length>0},formatNativeUrl(e,t,s){if(i.isHttpUrl(e))return this.formatUniversalUrl(e,t,s);let n=e;n.includes("://")||(n=e.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),this.setWalletConnectDeepLink(n,s);const a=encodeURIComponent(t);return`${n}wc?uri=${a}`},formatUniversalUrl(e,t,s){if(!i.isHttpUrl(e))return this.formatNativeUrl(e,t,s);let n=e;n.endsWith("/")||(n=`${n}/`),this.setWalletConnectDeepLink(n,s);const a=encodeURIComponent(t);return`${n}wc?uri=${a}`},async wait(e){return new Promise(t=>{setTimeout(t,e)})},openHref(e,t){window.open(e,t,"noreferrer noopener")},setWalletConnectDeepLink(e,t){try{localStorage.setItem(i.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(e){try{const[t]=e.split("?");localStorage.setItem(i.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:"Android"}))}catch{console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(i.WALLETCONNECT_DEEPLINK_CHOICE)}catch{console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{typeof localStorage<"u"&&localStorage.setItem(i.WCM_VERSION,"2.6.0")}catch{console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var e;const t=(e=N.state.data)==null?void 0:e.Wallet;if(!t)throw new Error('Missing "Wallet" view data');return t}},x=typeof location<"u"&&(location.hostname.includes("localhost")||location.protocol.includes("https")),r=p({enabled:x,userSessionId:"",events:[],connectedWalletId:void 0}),T={state:r,subscribe(e){return h(r.events,()=>e(S(r.events[r.events.length-1])))},initialize(){r.enabled&&typeof(crypto==null?void 0:crypto.randomUUID)<"u"&&(r.userSessionId=crypto.randomUUID())},setConnectedWalletId(e){r.connectedWalletId=e},click(e){if(r.enabled){const t={type:"CLICK",name:e.name,userSessionId:r.userSessionId,timestamp:Date.now(),data:e};r.events.push(t)}},track(e){if(r.enabled){const t={type:"TRACK",name:e.name,userSessionId:r.userSessionId,timestamp:Date.now(),data:e};r.events.push(t)}},view(e){if(r.enabled){const t={type:"VIEW",name:e.name,userSessionId:r.userSessionId,timestamp:Date.now(),data:e};r.events.push(t)}}},l=p({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),d={state:l,subscribe(e){return h(l,()=>e(l))},setChains(e){l.chains=e},setWalletConnectUri(e){l.walletConnectUri=e},setIsCustomDesktop(e){l.isCustomDesktop=e},setIsCustomMobile(e){l.isCustomMobile=e},setIsDataLoaded(e){l.isDataLoaded=e},setIsUiLoaded(e){l.isUiLoaded=e},setIsAuth(e){l.isAuth=e}},W=p({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),f={state:W,subscribe(e){return h(W,()=>e(W))},setConfig(e){var t,s;T.initialize(),d.setChains(e.chains),d.setIsAuth(Boolean(e.enableAuthMode)),d.setIsCustomMobile(Boolean((t=e.mobileWallets)==null?void 0:t.length)),d.setIsCustomDesktop(Boolean((s=e.desktopWallets)==null?void 0:s.length)),i.setModalVersionInStorage(),Object.assign(W,e)}},w="https://explorer-api.walletconnect.com";async function L(e,t){const s=new URL(e,w);return s.searchParams.append("projectId",f.state.projectId),Object.entries(t).forEach(([n,a])=>{a&&s.searchParams.append(n,String(a))}),(await fetch(s)).json()}const m={async getDesktopListings(e){return L("/w3m/v1/getDesktopListings",e)},async getMobileListings(e){return L("/w3m/v1/getMobileListings",e)},async getInjectedListings(e){return L("/w3m/v1/getInjectedListings",e)},async getAllListings(e){return L("/w3m/v1/getAllListings",e)},getWalletImageUrl(e){return`${w}/w3m/v1/getWalletImage/${e}?projectId=${f.state.projectId}`},getAssetImageUrl(e){return`${w}/w3m/v1/getAssetImage/${e}?projectId=${f.state.projectId}`}};var $=Object.defineProperty,O=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,U=(e,t,s)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,R=(e,t)=>{for(var s in t||(t={}))P.call(t,s)&&U(e,s,t[s]);if(O)for(var s of O(t))_.call(t,s)&&U(e,s,t[s]);return e};const M=i.isMobile(),c=p({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),q={state:c,async getRecomendedWallets(){const{explorerRecommendedWalletIds:e,explorerExcludedWalletIds:t}=f.state;if(e==="NONE"||t==="ALL"&&!e)return c.recomendedWallets;if(i.isArray(e)){const s={recommendedIds:e.join(",")},{listings:n}=await m.getAllListings(s),a=Object.values(n);a.sort((u,v)=>{const C=e.indexOf(u.id),y=e.indexOf(v.id);return C-y}),c.recomendedWallets=a}else{const{chains:s,isAuth:n}=d.state,a=s?.join(","),u=i.isArray(t),v={page:1,sdks:n?"auth_v1":void 0,entries:i.RECOMMENDED_WALLET_AMOUNT,chains:a,version:2,excludedIds:u?t.join(","):void 0},{listings:C}=M?await m.getMobileListings(v):await m.getDesktopListings(v);c.recomendedWallets=Object.values(C)}return c.recomendedWallets},async getWallets(e){const t=R({},e),{explorerRecommendedWalletIds:s,explorerExcludedWalletIds:n}=f.state,{recomendedWallets:a}=c;if(n==="ALL")return c.wallets;a.length?t.excludedIds=a.map(k=>k.id).join(","):i.isArray(s)&&(t.excludedIds=s.join(",")),i.isArray(n)&&(t.excludedIds=[t.excludedIds,n].filter(Boolean).join(",")),d.state.isAuth&&(t.sdks="auth_v1");const{page:u,search:v}=e,{listings:C,total:y}=M?await m.getMobileListings(t):await m.getDesktopListings(t),E=Object.values(C),A=v?"search":"wallets";return c[A]={listings:[...c[A].listings,...E],total:y,page:u??1},{listings:E,total:y}},getWalletImageUrl(e){return m.getWalletImageUrl(e)},getAssetImageUrl(e){return m.getAssetImageUrl(e)},resetSearch(){c.search={listings:[],total:0,page:1}}},I=p({open:!1}),F={state:I,subscribe(e){return h(I,()=>e(I))},async open(e){return new Promise(t=>{const{isUiLoaded:s,isDataLoaded:n}=d.state;if(d.setWalletConnectUri(e?.uri),d.setChains(e?.chains),N.reset("ConnectWallet"),s&&n)I.open=!0,t();else{const a=setInterval(()=>{const u=d.state;u.isUiLoaded&&u.isDataLoaded&&(clearInterval(a),I.open=!0,t())},200)}})},close(){I.open=!1}};var H=Object.defineProperty,D=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,j=(e,t,s)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,K=(e,t)=>{for(var s in t||(t={}))B.call(t,s)&&j(e,s,t[s]);if(D)for(var s of D(t))V.call(t,s)&&j(e,s,t[s]);return e};function z(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const b=p({themeMode:z()?"dark":"light"}),G={state:b,subscribe(e){return h(b,()=>e(b))},setThemeConfig(e){const{themeMode:t,themeVariables:s}=e;t&&(b.themeMode=t),s&&(b.themeVariables=K({},s))}},g=p({open:!1,message:"",variant:"success"}),Q={state:g,subscribe(e){return h(g,()=>e(g))},openToast(e,t){g.open=!0,g.message=e,g.variant=t},closeToast(){g.open=!1}};export{f as ConfigCtrl,i as CoreUtil,T as EventsCtrl,q as ExplorerCtrl,F as ModalCtrl,d as OptionsCtrl,N as RouterCtrl,G as ThemeCtrl,Q as ToastCtrl};
//# sourceMappingURL=index.js.map
